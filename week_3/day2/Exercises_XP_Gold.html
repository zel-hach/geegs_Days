<!DOCTYPE html>
<html>
    <head>
        <title>Exercises XP Gold</title>
    </head>
    <style>
        .container{
            width: 400px;
            height: 400px;
            border: 1px solid black;
            padding: 5px;
        }
    </style>
    <body>
        <div class="container" id="container"></div>
    </body>
    <script>
    ///////////////////////////////////////////////////////////////////////////////// exercice 1 //////////////////////////////////////////////////////////////////

         async function getData(){
            try{
                const response = await fetch(`https://api.giphy.com/v1/gifs/search?q=hilarious&rating=g&api_key=Sv4f9M9oTdGNaWRTwIcXFcsI4owQxgf4`);
                 if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                const data = await response.json();
                const randomData = data.data[Math.floor(Math.random() * data.data.length)];
                const div = document.getElementById('container');
                const img = document.createElement('img');
                img.src = randomData.images.original.url;
                img.style.width='400px';
                img.style.height='400px';
                div.appendChild(img);
                
            }catch(e){
                console.log('cannot fetch data: ',e.message);
            }
        }
        getData();



///////////////////////////////////////////////////////////////////////////////// exercice 2 //////////////////////////////////////////////////////////////////
let resolveAfter2Seconds = function () {
    console.log("starting slow promise");
    return new Promise(resolve => {
        setTimeout(function () {
            resolve("slow");
            console.log("slow promise is done");
        }, 2000);
    });
};

let resolveAfter1Second = function () {
    console.log("starting fast promise");
    return new Promise(resolve => {
        setTimeout(function () {
            resolve("fast");
            console.log("fast promise is done");
        }, 1000);
    });
};

let sequentialStart = async function () {
    console.log('==SEQUENTIAL START==');
    const slow = await resolveAfter2Seconds();
    console.log(slow);
    const fast = await resolveAfter1Second();
    console.log(fast);
}

sequentialStart() // result => ==SEQUENTIAL START==
                            //starting slow promise
                            //slow promise is done
                            //slow
                            //starting fast promise
                            //fast promise is done
                            //fast
///////////////////////////////////////////////////////////////////////////////// exercice 3 //////////////////////////////////////////////////////////////////

let resolveAfter2Seconds1 = function () {
    console.log("starting slow promise");
    return new Promise(resolve => {
        setTimeout(function () {
            resolve("slow");
            console.log("slow promise is done");
        }, 2000);
    });
};

let resolveAfter1Second1 = function () {
    console.log("starting fast promise");
    return new Promise(resolve => {
        setTimeout(function () {
            resolve("fast");
            console.log("fast promise is done");
        }, 1000);
    });
};

let concurrentStart = async function () {
    console.log('==CONCURRENT START with await==');
    const slow = resolveAfter2Seconds1();
    const fast = resolveAfter1Second1();
    console.log(await slow);
    console.log(await fast);
}

setTimeout(concurrentStart, 4000)// result => ==CONCURRENT START with await==
                            //starting slow promise
                            //starting fast promise
                            //fast promise is done
                            //slow promise is done
                            //slow
                            //fast
///////////////////////////////////////////////////////////////////////////////// exercice 4 //////////////////////////////////////////////////////////////////

const urls = [
  "https://jsonplaceholder.typicode.com/users",
  "https://jsonplaceholder.typicode.com/posts",
  "https://jsonplaceholder.typicode.com/albums"
];

const getData1 = async function () {
  try {
    const responses = await Promise.all(
      urls.map(url => fetch(url))
    );
    responses.forEach(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
    });
    const [users, posts, albums] = await Promise.all(
      responses.map(response => response.json())
    );
    console.log("users", users);
    console.log("posts", posts);
    console.log("albums", albums);

  } catch (error) {
    console.error("Ooooooops:", error.message);
  }
};

getData1();
    </script>
</html>